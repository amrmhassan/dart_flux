fix router base path algorithm

make test for upper lower middlewares in router and hanlder and server

tests for Router.path